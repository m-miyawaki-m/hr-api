ã¨ã¦ã‚‚è‰¯ã„è³ªå•ã§ã™ã€‚
ã€Œã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆCacheï¼‰ã€ã¨ã€Œã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼ˆSessionï¼‰ã€ã¯ã€ã©ã¡ã‚‰ã‚‚**ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€æ™‚çš„ã«ä¿å­˜ã—ã¦é«˜é€ŸåŒ–ãƒ»åˆ©ä¾¿æ€§ã‚’é«˜ã‚ã‚‹ä»•çµ„ã¿**ã§ã™ãŒã€
ç›®çš„ãƒ»ä¿å­˜å ´æ‰€ãƒ»å¯¿å‘½ãƒ»æ‰±ã†ãƒ‡ãƒ¼ã‚¿ã®æ€§è³ªãŒã¾ã£ãŸãé•ã„ã¾ã™ã€‚

Web ã‚„ã‚¢ãƒ—ãƒªé–‹ç™ºã§ã¯æ··åŒã•ã‚Œã‚„ã™ã„æ¦‚å¿µãªã®ã§ã€
ã“ã“ã§ **ä»•çµ„ã¿ãƒ»ç”¨é€”ãƒ»é•ã„** ã‚’æ˜ç¢ºã«æ•´ç†ã—ã¾ã—ã‚‡ã†ã€‚

---

# ğŸ§© 1. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆCacheï¼‰ã¨ã¯

## ğŸ”¹ æ¦‚å¿µ

> **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨ã¯ã€å†åˆ©ç”¨ã§ãã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€æ™‚çš„ã«ä¿å­˜ã—ã¦ã€æ¬¡ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’é«˜é€ŸåŒ–ã™ã‚‹ä»•çµ„ã¿ã€‚**

ç°¡å˜ã«è¨€ã†ã¨ï¼š

> ã€Œã¾ãŸåŒã˜ã‚‚ã®ã‚’å–ã‚Šã«è¡Œãã®ã¯ã‚‚ã£ãŸã„ãªã„ã‹ã‚‰ã€æ‰‹å…ƒã«å–ã£ã¦ãŠã“ã†ã€‚ã€

---

## âœ… ä¸»ãªç›®çš„

-   é€šä¿¡ã‚„è¨ˆç®—ã‚’çœç•¥ã—ã¦**é€Ÿåº¦ã‚’ä¸Šã’ã‚‹**
-   ã‚µãƒ¼ãƒè² è·ã‚’è»½æ¸›
-   ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã‚’å‘ä¸Šã•ã›ã‚‹ï¼ˆãƒšãƒ¼ã‚¸è¡¨ç¤ºã‚’é€Ÿãï¼‰

---

## âœ… ä¿å­˜ã•ã‚Œã‚‹å ´æ‰€ã¨å¯¾è±¡

| ç¨®é¡                   | ä¿å­˜å ´æ‰€                  | å¯¾è±¡ãƒ‡ãƒ¼ã‚¿                   | ä¾‹                           |
| ---------------------- | ------------------------- | ---------------------------- | ---------------------------- |
| **ãƒ–ãƒ©ã‚¦ã‚¶ã‚­ãƒ£ãƒƒã‚·ãƒ¥** | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã® PCï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰ | HTML / CSS / JS / ç”»åƒ       | Web ã‚µã‚¤ãƒˆã®å†è¡¨ç¤ºãŒé€Ÿããªã‚‹ |
| **ã‚µãƒ¼ãƒã‚­ãƒ£ãƒƒã‚·ãƒ¥**   | Web ã‚µãƒ¼ãƒãƒ»CDN           | API ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ»é™çš„ãƒ•ã‚¡ã‚¤ãƒ« | Cloudflare, Varnish ãªã©     |
| **ã‚¢ãƒ—ãƒªå†…ã‚­ãƒ£ãƒƒã‚·ãƒ¥** | ãƒ¡ãƒ¢ãƒª / ãƒ­ãƒ¼ã‚«ãƒ« DB      | è¨ˆç®—çµæœã‚„ API çµæœ          | ã‚¹ãƒãƒ›ã‚¢ãƒ—ãƒªã®ä¸€æ™‚ä¿å­˜       |

---

## âœ… å¯¿å‘½ï¼ˆæœ‰åŠ¹æœŸé™ï¼‰

-   æ˜ç¤ºçš„ã«è¨­å®šï¼ˆä¾‹ï¼š`Cache-Control: max-age=3600`ï¼‰
-   æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚ŒãŸã‚‰å†å–å¾—ï¼ˆæ›´æ–°ï¼‰
-   ã‚ãã¾ã§ã€Œå†åˆ©ç”¨ã§ãã‚‹ãªã‚‰ä½¿ã†ã€ã‚‚ã®

---

## âœ… ä¾‹ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰

```http
Cache-Control: max-age=86400
```

â¡ ã€Œã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ 1 æ—¥é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã¦ OKã€

---

## âœ… æ³¨æ„ç‚¹

-   ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒå¤ã„ã¾ã¾ã ã¨ã€Œæœ€æ–°ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œãªã„ã€ã“ã¨ã‚‚ã‚ã‚‹
-   æ›´æ–°é »åº¦ãŒé«˜ã„ãƒ‡ãƒ¼ã‚¿ã«ã¯**ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç„¡åŠ¹åŒ–**ã™ã‚‹ã“ã¨ã‚‚ã‚ã‚‹

---

# ğŸ§± 2. ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼ˆSessionï¼‰ã¨ã¯

## ğŸ”¹ æ¦‚å¿µ

> **ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¨ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã‚µãƒ¼ãƒã®ã€Œä¸€æ™‚çš„ãªæ¥ç¶šçŠ¶æ…‹ã€ã‚’ä¿æŒã™ã‚‹ä»•çµ„ã¿ã€‚**

ã¤ã¾ã‚Šï¼š

> ã€Œã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä»Šã‚‚ãƒ­ã‚°ã‚¤ãƒ³ä¸­ã§ã‚ã‚‹ã“ã¨ã€ã‚’è¦šãˆã¦ãŠãã€‚

---

## âœ… ä¸»ãªç›®çš„

-   **ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®çŠ¶æ…‹ç®¡ç†**
-   ãƒ­ã‚°ã‚¤ãƒ³ä¸­ã‹ã©ã†ã‹ã€ã‚«ãƒ¼ãƒˆã«ä½•ãŒå…¥ã£ã¦ã„ã‚‹ã‹ã€ã©ã®ãƒšãƒ¼ã‚¸ã‚’è¦‹ãŸã‹ã€ãªã©ã‚’è¨˜æ†¶

---

## âœ… ä¿å­˜ã•ã‚Œã‚‹å ´æ‰€ã¨å¯¾è±¡

| ä¿å­˜å ´æ‰€       | å†…å®¹                                                                 |
| -------------- | -------------------------------------------------------------------- |
| **ã‚µãƒ¼ãƒå´**   | ã‚»ãƒƒã‚·ãƒ§ãƒ³ ID ã«ç´ã¥ã„ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ï¼ˆä¾‹ï¼šãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã€ã‚«ãƒ¼ãƒˆå†…å®¹ï¼‰ |
| **ãƒ–ãƒ©ã‚¦ã‚¶å´** | ã‚»ãƒƒã‚·ãƒ§ãƒ³ IDï¼ˆCookie ã¨ã—ã¦ä¿å­˜ï¼‰                                   |

ä¾‹ï¼ˆCookie å†…ï¼‰ï¼š

```
sessionid=abc123xyz
```

ã‚µãƒ¼ãƒå´ï¼š

```json
{
    "abc123xyz": {
        "user": "miyawaki",
        "cart": ["item01", "item02"],
        "login": true
    }
}
```

---

## âœ… å¯¿å‘½ï¼ˆæœ‰åŠ¹æœŸé–“ï¼‰

-   ãƒ–ãƒ©ã‚¦ã‚¶ã‚’é–‰ã˜ã‚‹ã¾ã§ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ Cookieï¼‰
-   ä¸€å®šæ™‚é–“æ“ä½œãŒãªã‘ã‚Œã°ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆä¾‹ï¼š30 åˆ†ï¼‰

---

## âœ… æ³¨æ„ç‚¹

-   ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯**ãƒ¦ãƒ¼ã‚¶ãƒ¼å˜ä½ã®çŠ¶æ…‹ä¿æŒ**
-   ID ã‚„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã©ã®å€‹äººæƒ…å ±ã‚’ç›´æ¥ãƒ–ãƒ©ã‚¦ã‚¶ã«ä¿å­˜ã—ãªã„ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãŸã‚ï¼‰

---

# âš–ï¸ 3. ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®é•ã„ã¾ã¨ã‚

| æ¯”è¼ƒé …ç›®       | ã‚­ãƒ£ãƒƒã‚·ãƒ¥ (Cache)                     | ã‚»ãƒƒã‚·ãƒ§ãƒ³ (Session)                   |
| -------------- | -------------------------------------- | -------------------------------------- |
| **ç›®çš„**       | ãƒ‡ãƒ¼ã‚¿å†åˆ©ç”¨ã«ã‚ˆã‚‹é«˜é€ŸåŒ–               | ãƒ¦ãƒ¼ã‚¶ãƒ¼çŠ¶æ…‹ã®ç¶­æŒ                     |
| **å¯¾è±¡ãƒ‡ãƒ¼ã‚¿** | é™çš„ãƒ‡ãƒ¼ã‚¿ï¼ˆç”»åƒãƒ»HTMLãƒ»API çµæœãªã©ï¼‰ | å€‹åˆ¥ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ãƒ»ã‚«ãƒ¼ãƒˆãªã©ï¼‰ |
| **ä¿å­˜å ´æ‰€**   | ä¸»ã«ãƒ–ãƒ©ã‚¦ã‚¶ã‚„ã‚µãƒ¼ãƒï¼ˆCDNï¼‰            | ã‚µãƒ¼ãƒå´ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ï¼‰ï¼‹ Cookie      |
| **æœ‰åŠ¹æœŸé™**   | æŒ‡å®šæ™‚é–“çµŒéã§ç„¡åŠ¹åŒ–                   | ãƒ–ãƒ©ã‚¦ã‚¶çµ‚äº†ãƒ»ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã§å‰Šé™¤       |
| **ã‚¹ã‚³ãƒ¼ãƒ—**   | ã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§å…±æœ‰                 | å„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«å€‹åˆ¥                   |
| **åˆ©ç”¨ç›®çš„**   | è¡¨ç¤ºé€Ÿåº¦ãƒ»åŠ¹ç‡                         | èªè¨¼ãƒ»ç¶™ç¶šçš„æ“ä½œ                       |
| **ä»£è¡¨æŠ€è¡“**   | `Cache-Control`, `localStorage`, CDN   | `Session ID`, `Cookie`, `JWT`          |

---

# ğŸ§  4. é–¢é€£ã™ã‚‹é¡ä¼¼æ¦‚å¿µï¼ˆæ··åŒæ³¨æ„ï¼‰

| ç”¨èª                              | æ¦‚è¦                                                         |
| --------------------------------- | ------------------------------------------------------------ |
| **Cookie**                        | å°ã•ãªãƒ‡ãƒ¼ã‚¿ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã«ä¿å­˜ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ ID ãªã©ã‚’å…¥ã‚Œã‚‹ï¼‰   |
| **localStorage / sessionStorage** | Web Storage APIï¼ˆJS ã‹ã‚‰æ“ä½œã§ãã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥çš„é ˜åŸŸï¼‰         |
| **JWT (JSON Web Token)**          | ã‚»ãƒƒã‚·ãƒ§ãƒ³ä»£æ›¿ã§ä½¿ã‚ã‚Œã‚‹ãƒˆãƒ¼ã‚¯ãƒ³å‹èªè¨¼ï¼ˆã‚µãƒ¼ãƒãƒ¬ã‚¹æ§‹æˆå‘ã‘ï¼‰ |

---

# ğŸ§© 5. å›³ã§ç†è§£ã™ã‚‹

```
ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã€‘
ãƒ–ãƒ©ã‚¦ã‚¶ â”€â”€ä¿å­˜â†’ HTML/CSS/JS/ç”»åƒ
           â†å†åˆ©ç”¨â”€â”€ æ¬¡ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒé«˜é€ŸåŒ–
ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å…¨ä½“ã§å…±é€šï¼‰

ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã€‘
ãƒ–ãƒ©ã‚¦ã‚¶ â”€â”€Cookieï¼ˆSessionIDï¼‰â†’ ã‚µãƒ¼ãƒ
ã‚µãƒ¼ãƒ â”€â”€Sessionæƒ…å ±ï¼ˆuserã”ã¨ï¼‰ã‚’ä¿æŒ
           â†çŠ¶æ…‹ã‚’ç¶­æŒâ”€â”€ ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ãªã©
ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«å€‹åˆ¥ï¼‰
```

---

# ğŸ’¡ 6. å®Ÿå‹™ã§ã®ä½¿ã„åˆ†ã‘ä¾‹

| ã‚·ãƒ¼ãƒ³                      | ã©ã¡ã‚‰ã‚’ä½¿ã†ï¼Ÿ | ç†ç”±                                         |
| --------------------------- | -------------- | -------------------------------------------- |
| Web ãƒšãƒ¼ã‚¸ã‚’é«˜é€Ÿè¡¨ç¤ºã—ãŸã„  | ã‚­ãƒ£ãƒƒã‚·ãƒ¥     | é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†åˆ©ç”¨                         |
| ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã‚’ç¶­æŒã—ãŸã„    | ã‚»ãƒƒã‚·ãƒ§ãƒ³     | å€‹äººè­˜åˆ¥ãŒå¿…è¦                               |
| å•†å“ä¸€è¦§ã‚’ API ã‹ã‚‰å®šæœŸå–å¾— | ã‚­ãƒ£ãƒƒã‚·ãƒ¥     | å†…å®¹ãŒä¸€å®šæ™‚é–“å¤‰ã‚ã‚‰ãªã„                     |
| ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ã‚«ãƒ¼ãƒˆ          | ã‚»ãƒƒã‚·ãƒ§ãƒ³     | ãƒ¦ãƒ¼ã‚¶ãƒ¼å˜ä½ã®çŠ¶æ…‹                           |
| SPA ã®çŠ¶æ…‹ç®¡ç†              | ä¸¡æ–¹           | UI çŠ¶æ…‹ã‚’ localStorage, ãƒ­ã‚°ã‚¤ãƒ³ã‚’ã‚»ãƒƒã‚·ãƒ§ãƒ³ |

---

# ğŸ“˜ ã¾ã¨ã‚

| è¦³ç‚¹     | ã‚­ãƒ£ãƒƒã‚·ãƒ¥               | ã‚»ãƒƒã‚·ãƒ§ãƒ³                 |
| -------- | ------------------------ | -------------------------- |
| æœ¬è³ª     | ãƒ‡ãƒ¼ã‚¿ã‚’å†åˆ©ç”¨ã—ã¦é«˜é€ŸåŒ– | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®çŠ¶æ…‹ã‚’ä¿æŒ       |
| ä¿å­˜å ´æ‰€ | ãƒ–ãƒ©ã‚¦ã‚¶ãƒ»ã‚µãƒ¼ãƒãƒ»CDN    | ã‚µãƒ¼ãƒï¼‹ Cookie            |
| æ™‚é–“     | æœ‰åŠ¹æœŸé™ãƒ™ãƒ¼ã‚¹           | ãƒ–ãƒ©ã‚¦ã‚¶çµ‚äº†ãƒ»ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ |
| æ€§è³ª     | å…±é€šãƒ‡ãƒ¼ã‚¿               | å€‹åˆ¥ãƒ‡ãƒ¼ã‚¿                 |
| ç”¨é€”     | é€Ÿåº¦æœ€é©åŒ–               | èªè¨¼ãƒ»çŠ¶æ…‹ç®¡ç†             |

---

ã‚‚ã—æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã«é€²ã‚€ãªã‚‰ ğŸ‘‡

-   ğŸ”¹ã€ŒCookie / Session / Tokenï¼ˆJWTï¼‰ã®é•ã„ã¨èªè¨¼ã®ä»•çµ„ã¿ã€
-   ğŸ”¹ã€ŒWeb Storage APIï¼ˆlocalStorage / sessionStorageï¼‰ã®å®Ÿè·µçš„ä½¿ã„åˆ†ã‘ã€

ã©ã¡ã‚‰ã‚’æ·±æ˜ã‚Šã—ã¦ã¿ãŸã„ã§ã™ã‹ï¼Ÿ

ã¨ã¦ã‚‚æœ¬è³ªçš„ãªè³ªå•ã§ã™ã€‚
Springï¼ˆJavaï¼‰ã¨ JavaScriptï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰ãŒé€£æºã™ã‚‹ã¨ãã€**ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®å½¹å‰²**ã¯ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç¶™ç¶šçš„ãªè­˜åˆ¥ã¨çŠ¶æ…‹ç®¡ç†ã€ã‚’æ‹…ã„ã¾ã™ã€‚
ãŸã ã—ã€Web ã‚¢ãƒ—ãƒªã®æ§‹æˆï¼ˆã‚µãƒ¼ãƒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‹ SPA ã‹ï¼‰ã«ã‚ˆã£ã¦ä»•çµ„ã¿ãŒç•°ãªã‚Šã¾ã™ã€‚
ã“ã“ã§ã¯ã€ä¸¡è€…ã®é€£æºæ§‹é€ ã¨ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®å½¹ç›®ã‚’å›³è§£ï¼‹å®Ÿä¾‹ã§ã‚ã‹ã‚Šã‚„ã™ãæ•´ç†ã—ã¾ã™ã€‚

---

# ğŸ§© 1. å‰æï¼šSpring ã¨ JavaScript ã®é–¢ä¿‚

Web ã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã™ã‚‹éš›ã€æ§‹æˆã¯å¤§ãã 2 é€šã‚Šã‚ã‚Šã¾ã™ã€‚

| æ§‹æˆ                                                  | æ¦‚è¦                                         | ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ä½¿ã‚ã‚Œæ–¹                         |
| ----------------------------------------------------- | -------------------------------------------- | -------------------------------------------- |
| â‘  **Spring MVCï¼ˆã‚µãƒ¼ãƒã‚µã‚¤ãƒ‰ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ï¼‰**          | ç”»é¢ã‚’ Spring ãŒç”Ÿæˆï¼ˆJSP, Thymeleaf ãªã©ï¼‰  | ã‚µãƒ¼ãƒå´ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼ˆHttpSessionï¼‰ã§ç®¡ç†      |
| â‘¡ **SPA + APIï¼ˆãƒ•ãƒ­ãƒ³ãƒˆï¼šJS / ãƒãƒƒã‚¯ï¼šSpring Bootï¼‰** | JS ãŒ API ã‚’å‘¼ã³å‡ºã™ï¼ˆReact/Vue + REST APIï¼‰ | API é€šä¿¡æ™‚ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ï¼ˆCookie / Tokenï¼‰ |

ä¸¡è€…ã§ã€Œã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æŒã¡æ–¹ã€ãŒå¤‰ã‚ã‚Šã¾ã™ãŒã€
æ ¹æœ¬ã®å½¹å‰²ã¯åŒã˜ã§ã™ï¼š

> **â€œã“ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã€åŒã˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã‚‹ã‚‚ã®ã â€ ã¨ã‚µãƒ¼ãƒãŒè­˜åˆ¥ã™ã‚‹ãŸã‚ã®ä»•çµ„ã¿**

---

# âš™ï¸ 2. ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®åŸºæœ¬æ§‹é€ ï¼ˆSpringï¼‰

Spring ã§ã¯ã€ã‚µãƒ¼ãƒå´ã§ `HttpSession` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒè‡ªå‹•ã§ç®¡ç†ã•ã‚Œã¾ã™ã€‚

```java
@GetMapping("/login")
public String login(HttpSession session) {
    session.setAttribute("user", "miyawaki");
    return "home";
}
```

ã™ã‚‹ã¨ï¼š

-   ã‚µãƒ¼ãƒå´ã«ã€Œã‚»ãƒƒã‚·ãƒ§ãƒ³é ˜åŸŸã€ãŒä½œæˆã•ã‚Œã‚‹
-   ãƒ–ãƒ©ã‚¦ã‚¶ã«ã¯ `JSESSIONID` ã¨ã„ã† Cookie ãŒç™ºè¡Œã•ã‚Œã‚‹

ä¾‹ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶å´ Cookieï¼‰ï¼š

```
JSESSIONID=1A2B3C4D5E6F7890
```

Spring ã¯ã“ã® Cookie ã‚’ä½¿ã£ã¦ã€Œã©ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‹ã€ã‚’è­˜åˆ¥ã—ã¾ã™ã€‚

---

# ğŸŒ 3. JSï¼ˆãƒ•ãƒ­ãƒ³ãƒˆï¼‰ã¨ã®é€£æºã‚¤ãƒ¡ãƒ¼ã‚¸

```
ãƒ–ãƒ©ã‚¦ã‚¶ï¼ˆJSï¼‰            â†”            Springã‚µãƒ¼ãƒ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1ï¸âƒ£ POST /login   â”€â”€â”€â”€â”€â”€â†’  èªè¨¼æˆåŠŸ â†’ HttpSessionä½œæˆ
                        â†â”€ Set-Cookie: JSESSIONID=xxxx

2ï¸âƒ£ JSã‹ã‚‰APIå‘¼ã³å‡ºã— (fetchãªã©)
    fetch('/api/user')
                        â† Cookie(JSESSIONID) ã«ã‚ˆã‚ŠåŒä¸€ã‚»ãƒƒã‚·ãƒ§ãƒ³è­˜åˆ¥
```

â¡ **JavaScript ãŒ Cookie ã‚’è‡ªå‹•çš„ã«é€ä¿¡ã™ã‚‹** ã“ã¨ã§ã€
Spring å´ã¯ã€ŒåŒã˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç¶šãã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã€ã¨ã—ã¦æ‰±ãˆã¾ã™ã€‚

---

# ğŸ“¦ 4. å½¹å‰²ã¾ã¨ã‚ï¼šã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒæ‹…ã†ã“ã¨

| å½¹å‰²            | èª¬æ˜                                                  |
| --------------- | ----------------------------------------------------- |
| ğŸ”¹ èªè¨¼ã®ç¶­æŒ   | ä¸€åº¦ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸå¾Œã€å†ãƒ­ã‚°ã‚¤ãƒ³ãªã—ã§ API ã‚’åˆ©ç”¨ã§ãã‚‹ |
| ğŸ”¹ çŠ¶æ…‹ã®ä¿æŒ   | ã‚«ãƒ¼ãƒˆã€è¨­å®šã€é€”ä¸­å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ãªã©ã‚’ä¸€æ™‚ä¿å­˜            |
| ğŸ”¹ ãƒ¦ãƒ¼ã‚¶ãƒ¼è­˜åˆ¥ | Cookie ã® `JSESSIONID` ã«ã‚ˆã£ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ç´ã¥ã‘     |

---

# ğŸ§  5. JavaScript å´ã§ã®æ³¨æ„ç‚¹

JavaScriptï¼ˆç‰¹ã« SPAï¼‰ã§ Spring API ã‚’å‘¼ã³å‡ºã™å ´åˆã¯ã€
**Cookie ã‚’æ­£ã—ãæ‰±ã†è¨­å®šãŒå¿…è¦** ã§ã™ã€‚

---

## âœ… `fetch` ã®å ´åˆ

```js
fetch('https://example.com/api/user', {
    method: 'GET',
    credentials: 'include', // â† Cookieã‚’é€ã‚‹è¨­å®šãŒå¿…é ˆï¼
});
```

`credentials: "include"` ã‚’ä»˜ã‘ãªã„ã¨ã€
ãƒ–ãƒ©ã‚¦ã‚¶ã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Š Cookieï¼ˆJSESSIONIDï¼‰ã‚’é€ä¿¡ã—ã¾ã›ã‚“ã€‚

---

## âœ… Axios ã®å ´åˆ

```js
axios.get('/api/user', { withCredentials: true });
```

â¡ ã“ã‚Œã§ã€Spring å´ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¨ç´ã¥ã Cookie ãŒæ­£ã—ãé€ä¿¡ã•ã‚Œã¾ã™ã€‚

---

# ğŸ§± 6. Spring å´ã§ã®è¨­å®šï¼ˆCORS + Cookie å¯¾å¿œï¼‰

ãƒ•ãƒ­ãƒ³ãƒˆï¼ˆä¾‹ï¼šlocalhost:3000ï¼‰ã¨ Springï¼ˆlocalhost:8080ï¼‰ãŒåˆ¥ãƒ‰ãƒ¡ã‚¤ãƒ³ã®å ´åˆã€
**CORS è¨­å®š**ã¨**Cookie è¨±å¯**ãŒå¿…è¦ã§ã™ã€‚

```java
@Configuration
public class WebConfig {
    @Bean
    public WebMvcConfigurer corsConfigurer() {
        return new WebMvcConfigurer() {
            @Override
            public void addCorsMappings(CorsRegistry registry) {
                registry.addMapping("/api/**")
                        .allowedOrigins("http://localhost:3000")
                        .allowCredentials(true)
                        .allowedMethods("GET", "POST", "PUT", "DELETE");
            }
        };
    }
}
```

---

# ğŸ”’ 7. ã‚»ãƒƒã‚·ãƒ§ãƒ³ vs ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆJWTï¼‰

è¿‘å¹´ã® SPA æ§‹æˆã§ã¯ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ã¯ãªã **JWT ãƒˆãƒ¼ã‚¯ãƒ³** ã§çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹ã‚±ãƒ¼ã‚¹ã‚‚å¢—ãˆã¦ã„ã¾ã™ã€‚

| ç®¡ç†æ–¹å¼                     | ç‰¹å¾´                                        | ä¸»ãªç”¨é€”                              |
| ---------------------------- | ------------------------------------------- | ------------------------------------- |
| **ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼ˆJSESSIONIDï¼‰** | ã‚µãƒ¼ãƒå´ã«çŠ¶æ…‹ã‚’ä¿æŒ                        | ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã‚’ç¢ºå®Ÿã«ç®¡ç†ï¼ˆå¾“æ¥å‹ï¼‰    |
| **JWT ãƒˆãƒ¼ã‚¯ãƒ³**             | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã«çŠ¶æ…‹ã‚’åŸ‹ã‚è¾¼ã¿ï¼ˆstatelessï¼‰ | ã‚µãƒ¼ãƒãƒ¬ã‚¹ / ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹æ§‹æˆå‘ã‘ |

Spring Security ã§ã¯ã©ã¡ã‚‰ã‚‚åˆ©ç”¨å¯èƒ½ã€‚
React/Vue ãªã©ã® SPA ã§ã¯ JWT ã‚’æ¡ç”¨ã™ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ãŒã€
**ã‚µãƒ¼ãƒã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ã‚‚ååˆ†å®‰å…¨ãƒ»å®Ÿç”¨çš„**ã§ã™ã€‚

---

# ğŸ’¡ 8. å®Ÿå‹™ã§ã®æ§‹æˆä¾‹ï¼ˆå›³è§£ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆVue / Reactï¼‰  â”‚
â”‚  - ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ             â”‚
â”‚  - fetch/axiosã§APIé€šä¿¡         â”‚
â”‚  - Cookie(JSESSIONID)ã‚’è‡ªå‹•é€ä¿¡ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ HTTP + Cookie
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Spring Boot (Backend)           â”‚
â”‚  - èªè¨¼æˆåŠŸã§ HttpSession ä½œæˆ   â”‚
â”‚  - Cookieç™ºè¡Œï¼ˆJSESSIONIDï¼‰     â”‚
â”‚  - APIå‘¼å‡ºæ™‚ã«åŒã˜ã‚»ãƒƒã‚·ãƒ§ãƒ³å‚ç…§â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ã“ã‚Œã«ã‚ˆã‚Šï¼š

-   JS ã¯ãƒ­ã‚°ã‚¤ãƒ³å¾Œã«è‡ªç”±ã« API å‘¼ã³å‡ºã—å¯èƒ½
-   Spring ã¯ Cookie ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç‰¹å®šã—ã€çŠ¶æ…‹ã‚’ç¶™ç¶šç®¡ç†

---

# ğŸ“˜ 9. ã¾ã¨ã‚ï¼šSpringÃ—JS é€£æºæ™‚ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®å½¹ç›®

| è¦³ç‚¹           | å†…å®¹                                                                                |
| -------------- | ----------------------------------------------------------------------------------- |
| **ç›®çš„**       | JS ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã€ŒåŒã˜ãƒ­ã‚°ã‚¤ãƒ³ä¸­ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ã¨ã—ã¦è­˜åˆ¥                               |
| **ä»•çµ„ã¿**     | Cookieï¼ˆJSESSIONIDï¼‰ã§ã‚µãƒ¼ãƒå´ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ç´ã¥ã‘                                    |
| **JS è¨­å®š**    | `fetch(..., {credentials: "include"})` ã¾ãŸã¯ `axios(..., {withCredentials: true})` |
| **ã‚µãƒ¼ãƒè¨­å®š** | `CORS + allowCredentials(true)` ãŒå¿…è¦                                              |
| **ä»£æ›¿æ‰‹æ³•**   | JWT ãƒˆãƒ¼ã‚¯ãƒ³ã«ã‚ˆã‚‹ Stateless èªè¨¼ï¼ˆSPA ã‚„ API å‘ã‘ï¼‰                                |
| **å½¹å‰²ã¾ã¨ã‚** | èªè¨¼ç¶­æŒï¼çŠ¶æ…‹ä¿æŒï¼ãƒ¦ãƒ¼ã‚¶ãƒ¼è­˜åˆ¥ï¼ˆï¼ç¶™ç¶šçš„ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ï¼‰                          |

---

ã‚‚ã—æ¬¡ã«é€²ã‚ã‚‹ãªã‚‰ ğŸ‘‡

-   ğŸ”¹ **Spring Security ã§ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã®æµã‚Œï¼ˆãƒ­ã‚°ã‚¤ãƒ³ï½èªè¨¼ï½å¤±åŠ¹ï¼‰**
-   ğŸ”¹ **JWTï¼ˆãƒˆãƒ¼ã‚¯ãƒ³èªè¨¼ï¼‰ã¨ã‚»ãƒƒã‚·ãƒ§ãƒ³èªè¨¼ã®é•ã„ã¨é¸æŠåŸºæº–**

ã©ã¡ã‚‰ã‚’æ·±æ˜ã‚Šã—ã¾ã™ã‹ï¼Ÿ
æœ€é«˜ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã™ ğŸ‘
**Spring Ã— JavaScript é€£æº**ã‚’æœ¬æ ¼çš„ã«ç†è§£ã™ã‚‹ã†ãˆã§ã€
ã€Œã‚»ãƒƒã‚·ãƒ§ãƒ³èªè¨¼ã€ã¨ã€ŒJWTï¼ˆJSON Web Tokenï¼‰èªè¨¼ã€ã®é•ã„ã¯é¿ã‘ã¦é€šã‚Œã¾ã›ã‚“ã€‚

ä¸¡è€…ã¨ã‚‚ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è­˜åˆ¥ã—ã¦èªè¨¼ã‚’ç¶­æŒã™ã‚‹ã€ç›®çš„ã§ã™ãŒã€
**ã©ã“ã«æƒ…å ±ã‚’ä¿æŒã™ã‚‹ã‹**ã¨**ã©ã†è­˜åˆ¥ã™ã‚‹ã‹**ã®ä»•çµ„ã¿ãŒã¾ã£ãŸãç•°ãªã‚Šã¾ã™ã€‚

---

# ğŸ§© 1. ä¸¡è€…ã®ç›®çš„ï¼ˆå…±é€šç‚¹ï¼‰

| é …ç›®    | å†…å®¹                                                                                      |
| ------- | ----------------------------------------------------------------------------------------- |
| âœ… ç›®çš„ | ã€Œãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’è­˜åˆ¥ã—ã¦ã€ç¶™ç¶šçš„ã«ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã™ã‚‹ã€                          |
| âœ… é•ã„ | **ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼šçŠ¶æ…‹ã‚’ã‚µãƒ¼ãƒå´ã«ä¿å­˜** ï¼ **JWTï¼šçŠ¶æ…‹ã‚’ãƒˆãƒ¼ã‚¯ãƒ³å†…ã«åŸ‹ã‚è¾¼ã‚€ï¼ˆã‚µãƒ¼ãƒãƒ¬ã‚¹ï¼‰** |

---

# âš™ï¸ 2. ã‚»ãƒƒã‚·ãƒ§ãƒ³èªè¨¼ã®ä»•çµ„ã¿ï¼ˆå¾“æ¥å‹ï¼‰

## ğŸ”¹ æ¦‚è¦

> ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã«ã‚µãƒ¼ãƒãŒã€Œã‚»ãƒƒã‚·ãƒ§ãƒ³ã€ã‚’ä½œã‚Šã€
> ãã‚Œã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã® Cookie ã«ã‚ã‚‹ `JSESSIONID` ã¨ç´ã¥ã‘ã¦ç®¡ç†ã€‚

### å‡¦ç†ã®æµã‚Œ

```
1ï¸âƒ£ /login ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼åãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰é€ä¿¡
2ï¸âƒ£ ã‚µãƒ¼ãƒãŒèªè¨¼ â†’ ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆï¼ˆHttpSessionï¼‰
3ï¸âƒ£ Cookie ã« JSESSIONID=xxxx ã‚’ç™ºè¡Œ
4ï¸âƒ£ ä»¥å¾Œã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ Cookie çµŒç”±ã§åŒä¸€ã‚»ãƒƒã‚·ãƒ§ãƒ³è­˜åˆ¥
5ï¸âƒ£ ã‚µãƒ¼ãƒå´ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ä¿æŒ
```

---

### ã‚¤ãƒ¡ãƒ¼ã‚¸å›³

```
ãƒ–ãƒ©ã‚¦ã‚¶ â”€â”€ Cookie(JSESSIONID=123) â”€â”€â–¶ ã‚µãƒ¼ãƒ
ã‚µãƒ¼ãƒå´ï¼šSessionStore[123] = { user: 'miyawaki', role: 'admin' }
```

---

### âœ… ãƒ¡ãƒªãƒƒãƒˆ

-   å®Ÿè£…ãŒã‚·ãƒ³ãƒ—ãƒ«ï¼ˆSpring æ¨™æº–æ©Ÿèƒ½ï¼‰
-   ã‚µãƒ¼ãƒãŒãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å®‰å…¨ã«ä¿æŒï¼ˆæ”¹ã–ã‚“ãƒªã‚¹ã‚¯ãŒä½ã„ï¼‰
-   ã‚»ãƒƒã‚·ãƒ§ãƒ³å¤±åŠ¹ã‚‚ã‚µãƒ¼ãƒå´ã§åˆ¶å¾¡å¯èƒ½ï¼ˆlogout, timeoutï¼‰

### âš ï¸ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ

-   ã‚µãƒ¼ãƒå´ã«**ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±ã‚’ä¿æŒã™ã‚‹å¿…è¦**ï¼ˆãƒ¡ãƒ¢ãƒª/DB è² è·ï¼‰
-   è² è·åˆ†æ•£æ§‹æˆã§ã¯ã‚»ãƒƒã‚·ãƒ§ãƒ³å…±æœ‰ï¼ˆSticky Session or Redisï¼‰ãŒå¿…è¦
-   RESTful ã§ã¯ã€ŒçŠ¶æ…‹ã‚’æŒãŸãªã„è¨­è¨ˆã€ã«åã™ã‚‹ï¼ˆStatefulï¼‰

---

# ğŸ” 3. JWTï¼ˆJSON Web Tokenï¼‰èªè¨¼ã®ä»•çµ„ã¿ï¼ˆãƒ¢ãƒ€ãƒ³å‹ï¼‰

## ğŸ”¹ æ¦‚è¦

> ã‚µãƒ¼ãƒã¯ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã«ã€Œç½²åä»˜ããƒˆãƒ¼ã‚¯ãƒ³ã€ã‚’ç™ºè¡Œã—ã€
> ä»¥å¾Œã¯ãã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚’é€ã‚‹ã“ã¨ã§èªè¨¼ã‚’ç¶­æŒã€‚
> ã‚µãƒ¼ãƒå´ã«çŠ¶æ…‹ã‚’ä¿å­˜ã—ãªã„ï¼ˆStatelessï¼‰ã€‚

---

### å‡¦ç†ã®æµã‚Œ

```
1ï¸âƒ£ /login ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼åãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰é€ä¿¡
2ï¸âƒ£ èªè¨¼æˆåŠŸ â†’ ã‚µãƒ¼ãƒãŒ JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œ
3ï¸âƒ£ JSå´ãŒ localStorage ã¾ãŸã¯ Cookie ã«ä¿å­˜
4ï¸âƒ£ ä»¥å¾Œã®APIé€šä¿¡æ™‚ã« Authorizationãƒ˜ãƒƒãƒ€ã§é€ä¿¡
    Authorization: Bearer <JWTãƒˆãƒ¼ã‚¯ãƒ³>
5ï¸âƒ£ ã‚µãƒ¼ãƒã¯ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ¤œè¨¼ã—ã€ç½²åãƒ»æœ‰åŠ¹æœŸé™ã‚’ãƒã‚§ãƒƒã‚¯
```

---

### ãƒˆãƒ¼ã‚¯ãƒ³æ§‹é€ ï¼ˆ3 åˆ†å‰²ï¼‰

JWT ã¯ã€Œãƒ‰ãƒƒãƒˆ 3 ã¤ã€ã§åŒºåˆ‡ã‚‰ã‚ŒãŸæ–‡å­—åˆ—ã§ã™ã€‚

```
xxxxx.yyyyy.zzzzz
â†“ â†“ â†“
Header.Payload.Signature
```

| éƒ¨åˆ†      | å†…å®¹                           | ä¾‹                                                          |
| --------- | ------------------------------ | ----------------------------------------------------------- |
| Header    | ãƒˆãƒ¼ã‚¯ãƒ³ç¨®åˆ¥ï¼‹ç½²åã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ  | `{ "alg": "HS256", "typ": "JWT" }`                          |
| Payload   | ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ãƒ»æœ‰åŠ¹æœŸé™ãªã©     | `{ "sub": "miyawaki", "role": "admin", "exp": 1730200000 }` |
| Signature | ç½²åï¼ˆæ”¹ã–ã‚“é˜²æ­¢ï¼‰             | `HMACSHA256(base64(header + payload), secretKey)`           |

---

### âœ… ãƒ¡ãƒªãƒƒãƒˆ

-   **ã‚µãƒ¼ãƒå´ã§çŠ¶æ…‹ã‚’æŒãŸãªã„ï¼ˆStatelessï¼‰**
-   ã‚¹ã‚±ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆã—ã‚„ã™ã„ï¼ˆã‚µãƒ¼ãƒå¢—ã‚„ã—ã¦ã‚‚ OKï¼‰
-   ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ãƒ»ãƒ¢ãƒã‚¤ãƒ«ãƒ»SPA ã«é©ã™ã‚‹
-   å¤–éƒ¨ API é€£æºã«æµç”¨ã—ã‚„ã™ã„ï¼ˆOAuth2, OpenID Connectï¼‰

### âš ï¸ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ

-   ä¸€åº¦ç™ºè¡Œã—ãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’**ã‚µãƒ¼ãƒå´ã§ç„¡åŠ¹åŒ–ã§ããªã„**
-   ãƒˆãƒ¼ã‚¯ãƒ³æµå‡ºæ™‚ã«ãƒªã‚¹ã‚¯å¤§ï¼ˆèª°ã§ã‚‚å†åˆ©ç”¨å¯èƒ½ï¼‰
-   Payload ã¯**æš—å·åŒ–ã•ã‚Œãªã„**ï¼ˆBase64 ã§å¯èª­ï¼‰
-   æœ‰åŠ¹æœŸé™ãƒ»ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥å‡¦ç†ãŒå¿…è¦

---

# ğŸ§  4. ã‚»ãƒƒã‚·ãƒ§ãƒ³ vs JWT ã®å¯¾æ¯”è¡¨

| é …ç›®                | ã‚»ãƒƒã‚·ãƒ§ãƒ³èªè¨¼             | JWTï¼ˆãƒˆãƒ¼ã‚¯ãƒ³èªè¨¼ï¼‰                  |
| ------------------- | -------------------------- | ------------------------------------ |
| çŠ¶æ…‹ä¿æŒ            | ã‚µãƒ¼ãƒå´ã«ä¿å­˜ï¼ˆStatefulï¼‰ | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ï¼ˆStatelessï¼‰          |
| è­˜åˆ¥æ‰‹æ®µ            | Cookieï¼ˆJSESSIONIDï¼‰       | HTTP ãƒ˜ãƒƒãƒ€ï¼ˆAuthorization: Bearerï¼‰ |
| ä¿æŒå ´æ‰€            | ã‚µãƒ¼ãƒã®ãƒ¡ãƒ¢ãƒªï¼Redis ãªã© | ãƒ–ãƒ©ã‚¦ã‚¶ã® localStorage / Cookie     |
| æœ‰åŠ¹æœŸé™            | ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ     | ãƒˆãƒ¼ã‚¯ãƒ³ã® expï¼ˆç½²åä»˜ãï¼‰           |
| ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ          | ã‚µãƒ¼ãƒã§ã‚»ãƒƒã‚·ãƒ§ãƒ³ç ´æ£„     | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå‰Šé™¤ï¼ˆãƒªã‚¹ãƒˆåˆ¶å¾¡å¿…è¦ï¼‰   |
| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£        | æ¯”è¼ƒçš„å®‰å…¨ï¼ˆã‚µãƒ¼ãƒç®¡ç†ï¼‰   | ãƒˆãƒ¼ã‚¯ãƒ³æµå‡ºãƒªã‚¹ã‚¯ã‚ã‚Š               |
| ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£    | å¼±ã„ï¼ˆå…±æœ‰å¿…è¦ï¼‰           | å¼·ã„ï¼ˆStatelessï¼‰                    |
| REST è¨­è¨ˆã¨ã®æ•´åˆæ€§ | âŒ çŠ¶æ…‹ã‚ã‚Š                | âœ… çŠ¶æ…‹ãªã—                          |
| ä¸»ãªç”¨é€”            | ç¤¾å†…ãƒ»Web ã‚·ã‚¹ãƒ†ãƒ          | SPA / API / ãƒ¢ãƒã‚¤ãƒ«é€£æº             |

---

# ğŸŒ 5. å®Ÿéš›ã®æ§‹æˆã‚¤ãƒ¡ãƒ¼ã‚¸

### ğŸ§± ã‚»ãƒƒã‚·ãƒ§ãƒ³æ–¹å¼ï¼ˆSpring Security æ¨™æº–ï¼‰

```
[JS]
  â†“ Cookie(JSESSIONID)
[Spring Boot]
  HttpSession(useræƒ…å ±)
```

### âš¡ JWT æ–¹å¼ï¼ˆAPI æ§‹æˆï¼‰

```
[JS]
  â†“ Authorization: Bearer eyJhbGciOi...
[Spring Boot]
  ãƒˆãƒ¼ã‚¯ãƒ³ç½²åæ¤œè¨¼ â†’ OKãªã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ¸ˆã¿æ‰±ã„
```

---

# ğŸ§© 6. é¸æŠåŸºæº–ï¼ˆã©ã¡ã‚‰ã‚’æ¡ç”¨ã™ã¹ãã‹ï¼‰

| ã‚·ã‚¹ãƒ†ãƒ ã‚¿ã‚¤ãƒ—                       | ãŠã™ã™ã‚æ–¹å¼            | ç†ç”±                             |
| ------------------------------------ | ----------------------- | -------------------------------- |
| ä¼æ¥­å†…æ¥­å‹™ã‚¢ãƒ—ãƒªï¼ˆãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã‚ã‚Šï¼‰ | ğŸŸ© **ã‚»ãƒƒã‚·ãƒ§ãƒ³èªè¨¼**   | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é‡è¦–ãƒ»æ§‹æˆãŒã‚·ãƒ³ãƒ—ãƒ« |
| SPA æ§‹æˆï¼ˆReact/Vue + Spring APIï¼‰   | ğŸŸ¦ **JWT ãƒˆãƒ¼ã‚¯ãƒ³èªè¨¼** | ã‚µãƒ¼ãƒãƒ¬ã‚¹ãƒ»API é€£æºã—ã‚„ã™ã„     |
| ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹æ§‹æˆ                 | ğŸŸ¦ **JWT**              | ã‚µãƒ¼ãƒ“ã‚¹é–“èªè¨¼ã«é©ã™ã‚‹           |
| ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ãª Web ã‚µã‚¤ãƒˆ          | ğŸŸ© **ã‚»ãƒƒã‚·ãƒ§ãƒ³**       | çŸ­å‘½ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ååˆ†             |
| ãƒ¢ãƒã‚¤ãƒ«ãƒ»å¤–éƒ¨é€£æº API               | ğŸŸ¦ **JWT**              | å¤–éƒ¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰åˆ©ç”¨ã•ã‚Œã‚‹   |

---

# âš™ï¸ 7. ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ§‹æˆï¼ˆSpring Security ã§ã‚ˆãã‚ã‚‹æ§‹æˆï¼‰

å¤šãã®ä¼æ¥­ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€**ãƒ­ã‚°ã‚¤ãƒ³ã ã‘ã‚»ãƒƒã‚·ãƒ§ãƒ³ã€API ã¯ JWT** ã®ã‚ˆã†ã«åˆ†é›¢ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚

```
Webç”»é¢ï¼šã‚»ãƒƒã‚·ãƒ§ãƒ³èªè¨¼ï¼ˆJSESSIONIDï¼‰
APIé€šä¿¡ï¼šJWTèªè¨¼ï¼ˆAuthorizationãƒ˜ãƒƒãƒ€ï¼‰
```

â¡ ãƒ•ãƒ­ãƒ³ãƒˆï¼ˆJSï¼‰ã§ãƒˆãƒ¼ã‚¯ãƒ³ã‚’å—ã‘å–ã‚Šã€ä»¥å¾Œã¯ JWT ã§ API ã‚¢ã‚¯ã‚»ã‚¹ã€‚
â†’ Spring Security ã§ã¯ã€Œèªè¨¼ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã€ã‚’åˆ‡ã‚Šæ›¿ãˆã¦ä¸¡ç«‹å¯èƒ½ã€‚

---

# ğŸ§  8. Spring Security ã§ã®è¨­å®šã‚¤ãƒ¡ãƒ¼ã‚¸ï¼ˆJWT èªè¨¼ï¼‰

```java
@Bean
public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
    http.csrf().disable()
        .authorizeHttpRequests(auth -> auth
            .requestMatchers("/auth/**").permitAll()
            .anyRequest().authenticated())
        .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS)
        .addFilterBefore(new JwtAuthFilter(jwtProvider), UsernamePasswordAuthenticationFilter.class);
    return http.build();
}
```

ãƒã‚¤ãƒ³ãƒˆï¼š

-   `STATELESS` ã§ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ç„¡åŠ¹åŒ–
-   JWT ã‚’æ¤œè¨¼ã™ã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆ`JwtAuthFilter`ï¼‰ã§æ¯å›ç½²åç¢ºèª

---

# ğŸ“˜ 9. ã¾ã¨ã‚

| è¦³ç‚¹           | ã‚»ãƒƒã‚·ãƒ§ãƒ³èªè¨¼                  | JWT èªè¨¼                                  |
| -------------- | ------------------------------- | ----------------------------------------- |
| **ç®¡ç†æ–¹å¼**   | ã‚µãƒ¼ãƒå´ã«çŠ¶æ…‹ï¼ˆSessionï¼‰ã‚’ä¿æŒ | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã«ç½²åä»˜ããƒˆãƒ¼ã‚¯ãƒ³ä¿æŒ      |
| **èªè¨¼æ–¹æ³•**   | Cookie ã® `JSESSIONID`          | HTTP ãƒ˜ãƒƒãƒ€ã® `Authorization: Bearer`     |
| **æ§‹é€ **       | çŠ¶æ…‹ç®¡ç†ï¼ˆStatefulï¼‰            | ç„¡çŠ¶æ…‹ï¼ˆStatelessï¼‰                       |
| **ãƒ¡ãƒªãƒƒãƒˆ**   | ã‚»ã‚­ãƒ¥ã‚¢ãƒ»ã‚·ãƒ³ãƒ—ãƒ«              | åˆ†æ•£ãƒ»APIãƒ»å¤–éƒ¨é€£æºã«å¼·ã„                 |
| **ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ** | è² è·ãƒ»ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°èª²é¡Œ          | ç„¡åŠ¹åŒ–ãŒé›£ã—ã„ãƒ»æµå‡ºãƒªã‚¹ã‚¯                |
| **é©ç”¨ä¾‹**     | ç¤¾å†…ã‚·ã‚¹ãƒ†ãƒ ãƒ»Web æ¥­å‹™ã‚¢ãƒ—ãƒª    | SPA, ãƒ¢ãƒã‚¤ãƒ«, API é€£æº, ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ |

---

ã‚‚ã—æ¬¡ã«é€²ã‚ã‚‹ãªã‚‰ ğŸ‘‡

-   ğŸ”¹ **Spring Security ã§ã® JWT å®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆFilter + Token ç™ºè¡Œ + æ¤œè¨¼ï¼‰**
-   ğŸ”¹ **Cookie ãƒ™ãƒ¼ã‚¹ vs JWT ãƒ™ãƒ¼ã‚¹ã®èªè¨¼å®Ÿè£…æ¯”è¼ƒï¼ˆã‚³ãƒ¼ãƒ‰ä¸­å¿ƒï¼‰**

ã©ã¡ã‚‰ã‚’æ·±æ˜ã‚Šã—ã¦ã¿ãŸã„ã§ã™ã‹ï¼Ÿ
éå¸¸ã«å®Ÿè·µçš„ã§è‰¯ã„ãƒ†ãƒ¼ãƒã§ã™ ğŸ”¥
ã“ã“ã§ã¯ã€**Spring Boot Ã— JavaScript é€£æº**ã‚’å‰æã«ã€
ã€ŒCookie ãƒ™ãƒ¼ã‚¹ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³èªè¨¼ï¼‰ã€ã¨ã€ŒJWT ãƒ™ãƒ¼ã‚¹ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³èªè¨¼ï¼‰ã€ã®é•ã„ã‚’
**ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ™ãƒ«ã§å¯¾æ¯”**ã—ã¦ç†è§£ã§ãã‚‹ã‚ˆã†ã«æ•´ç†ã—ã¾ã™ã€‚

---

# ğŸ§© 1. æ¦‚è¦æ¯”è¼ƒï¼š2 ã¤ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®è€ƒãˆæ–¹

| é …ç›®        | Cookie ãƒ™ãƒ¼ã‚¹ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³èªè¨¼ï¼‰              | JWT ãƒ™ãƒ¼ã‚¹ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³èªè¨¼ï¼‰                                  |
| ----------- | -------------------------------------------- | ----------------------------------------------------------- |
| æ¦‚å¿µ        | ã‚µãƒ¼ãƒãŒãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«çŠ¶æ…‹ã‚’ä¿æŒï¼ˆStatefulï¼‰ | ã‚µãƒ¼ãƒã¯çŠ¶æ…‹ã‚’ä¿æŒã›ãšã€ãƒˆãƒ¼ã‚¯ãƒ³ã«ç½²åã—ã¦è¿”ã™ï¼ˆStatelessï¼‰ |
| é€šä¿¡        | Cookie ã« JSESSIONID ãŒè‡ªå‹•é€ä¿¡ã•ã‚Œã‚‹        | HTTP ãƒ˜ãƒƒãƒ€ã« Authorization: Bearer <token>                 |
| ä¿æŒå ´æ‰€    | ã‚µãƒ¼ãƒãƒ¡ãƒ¢ãƒª or Redis                        | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ (localStorage / Cookie)                      |
| ä¸»ãªç”¨é€”    | Web ã‚¢ãƒ—ãƒªï¼ˆSpring MVC, Thymeleaf ãªã©ï¼‰     | SPA / REST API / ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒª                             |
| Spring è¨­å®š | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® Spring Security                 | ç‹¬è‡ª JWT ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã§æ¤œè¨¼                                   |

---

# ğŸ§  2. Cookie ãƒ™ãƒ¼ã‚¹èªè¨¼ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰

## âœ… ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã®æµã‚Œ

```
1ï¸âƒ£ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ /login ã« POSTï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼‹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼‰
2ï¸âƒ£ Spring Security ãŒèªè¨¼
3ï¸âƒ£ ã‚µãƒ¼ãƒãŒ HttpSession ã‚’ä½œæˆã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ä¿æŒ
4ï¸âƒ£ Cookie ã« JSESSIONID ãŒè¨­å®šã•ã‚Œã‚‹
5ï¸âƒ£ ä»¥å¾Œã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯ Cookie çµŒç”±ã§åŒä¸€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¨åˆ¤åˆ¥
```

---

## âœ… Spring Security è¨­å®šä¾‹

```java
@Configuration
@EnableWebSecurity
public class SecurityConfig {

    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {
        http
            .csrf().disable()
            .authorizeHttpRequests(auth -> auth
                .requestMatchers("/login", "/public/**").permitAll()
                .anyRequest().authenticated())
            .formLogin(form -> form
                .loginPage("/login")           // ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
                .defaultSuccessUrl("/home"))   // èªè¨¼æˆåŠŸå¾Œ
            .logout(logout -> logout
                .logoutUrl("/logout")
                .deleteCookies("JSESSIONID"));
        return http.build();
    }
}
```

---

## âœ… ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ä¾‹

```java
@RestController
public class UserController {

    @GetMapping("/user")
    public Map<String, Object> getUser(HttpSession session) {
        Object user = session.getAttribute("user");
        return Map.of("user", user);
    }

    @PostMapping("/login")
    public ResponseEntity<?> login(@RequestParam String username,
                                   HttpSession session) {
        session.setAttribute("user", username);
        return ResponseEntity.ok(Map.of("message", "Login success"));
    }
}
```

---

## âœ… ãƒ•ãƒ­ãƒ³ãƒˆå´ï¼ˆJavaScriptï¼‰

```js
// Cookie ã¯è‡ªå‹•çš„ã«é€ä¿¡ã•ã‚Œã‚‹
fetch('/user', {
    method: 'GET',
    credentials: 'include', // â† åŒä¸€ã‚»ãƒƒã‚·ãƒ§ãƒ³ç¶­æŒã«å¿…è¦ï¼
})
    .then((res) => res.json())
    .then(console.log);
```

> ğŸ’¡ `credentials: "include"` ãŒãªã„ã¨ã€ãƒ–ãƒ©ã‚¦ã‚¶ã¯ Cookie ã‚’é€ã‚‰ãªã„ã€‚
> ã“ã‚ŒãŒ JS é€£æºæ™‚ã®æœ€é‡è¦ãƒã‚¤ãƒ³ãƒˆã€‚

---

# âš™ï¸ 3. JWT ãƒ™ãƒ¼ã‚¹èªè¨¼ï¼ˆStatelessï¼‰

## âœ… æµã‚Œ

```
1ï¸âƒ£ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ /auth/login ã« POSTï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼‹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼‰
2ï¸âƒ£ ã‚µãƒ¼ãƒãŒèªè¨¼å¾Œã« JWT ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ç™ºè¡Œã—ã¦è¿”ã™
3ï¸âƒ£ ãƒ•ãƒ­ãƒ³ãƒˆå´ã§ localStorage ã¾ãŸã¯ Cookie ã«ä¿å­˜
4ï¸âƒ£ ä»¥å¾Œã®APIå‘¼ã³å‡ºã—æ™‚ã« Authorizationãƒ˜ãƒƒãƒ€ã§é€ä¿¡
5ï¸âƒ£ ã‚µãƒ¼ãƒã¯ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ¤œè¨¼ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç‰¹å®šï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ãªã—ï¼‰
```

---

## âœ… Spring Security è¨­å®šï¼ˆJWTï¼‰

```java
@Configuration
@EnableWebSecurity
public class SecurityConfig {

    private final JwtAuthFilter jwtAuthFilter;

    public SecurityConfig(JwtAuthFilter jwtAuthFilter) {
        this.jwtAuthFilter = jwtAuthFilter;
    }

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http.csrf().disable()
            .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS) // ã‚»ãƒƒã‚·ãƒ§ãƒ³ç„¡åŠ¹åŒ–
            .and()
            .authorizeHttpRequests(auth -> auth
                .requestMatchers("/auth/**").permitAll()
                .anyRequest().authenticated())
            .addFilterBefore(jwtAuthFilter, UsernamePasswordAuthenticationFilter.class);
        return http.build();
    }
}
```

---

## âœ… JWT ç”Ÿæˆã‚¯ãƒ©ã‚¹

```java
@Component
public class JwtUtil {

    private final String SECRET_KEY = "my-secret-key";

    public String generateToken(String username) {
        return Jwts.builder()
                .setSubject(username)
                .setIssuedAt(new Date(System.currentTimeMillis()))
                .setExpiration(new Date(System.currentTimeMillis() + 1000 * 60 * 60)) // 1æ™‚é–“
                .signWith(SignatureAlgorithm.HS256, SECRET_KEY)
                .compact();
    }

    public String extractUsername(String token) {
        return Jwts.parser().setSigningKey(SECRET_KEY)
                .parseClaimsJws(token)
                .getBody().getSubject();
    }

    public boolean validateToken(String token) {
        try {
            extractUsername(token);
            return true;
        } catch (Exception e) {
            return false;
        }
    }
}
```

---

## âœ… ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆJWT èªè¨¼å‡¦ç†ï¼‰

```java
@Component
public class JwtAuthFilter extends OncePerRequestFilter {

    private final JwtUtil jwtUtil;

    public JwtAuthFilter(JwtUtil jwtUtil) {
        this.jwtUtil = jwtUtil;
    }

    @Override
    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response,
                                    FilterChain filterChain) throws ServletException, IOException {

        String authHeader = request.getHeader("Authorization");

        if (authHeader != null && authHeader.startsWith("Bearer ")) {
            String token = authHeader.substring(7);
            if (jwtUtil.validateToken(token)) {
                String username = jwtUtil.extractUsername(token);
                UsernamePasswordAuthenticationToken authentication =
                    new UsernamePasswordAuthenticationToken(username, null, List.of());
                SecurityContextHolder.getContext().setAuthentication(authentication);
            }
        }

        filterChain.doFilter(request, response);
    }
}
```

---

## âœ… ãƒ­ã‚°ã‚¤ãƒ³ APIï¼ˆãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œï¼‰

```java
@RestController
@RequestMapping("/auth")
public class AuthController {

    private final JwtUtil jwtUtil;

    public AuthController(JwtUtil jwtUtil) {
        this.jwtUtil = jwtUtil;
    }

    @PostMapping("/login")
    public ResponseEntity<?> login(@RequestParam String username) {
        String token = jwtUtil.generateToken(username);
        return ResponseEntity.ok(Map.of("token", token));
    }
}
```

---

## âœ… ãƒ•ãƒ­ãƒ³ãƒˆå´ï¼ˆJavaScriptï¼‰

```js
// ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—
let token = null;
fetch('/auth/login?username=miyawaki', { method: 'POST' })
    .then((res) => res.json())
    .then((data) => {
        token = data.token;
        localStorage.setItem('jwt', token);
    });

// èªè¨¼ä»˜ãAPIå‘¼ã³å‡ºã—
fetch('/api/user', {
    headers: {
        Authorization: 'Bearer ' + localStorage.getItem('jwt'),
    },
})
    .then((res) => res.json())
    .then(console.log);
```

> âœ… JWT æ–¹å¼ã§ã¯ã€**Cookie ã¯ä¸è¦**ã€‚
> ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ `Authorization` ãƒ˜ãƒƒãƒ€ã§é€ã‚‹ã ã‘ã€‚
> â†’ å®Œå…¨ã«ã€ŒStatelessã€ãª API é€šä¿¡ã€‚

---

# ğŸ§© 4. ãƒ­ã‚°ã‚¢ã‚¦ãƒˆå‡¦ç†ã®é•ã„

| èªè¨¼æ–¹å¼           | ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã®ä»•çµ„ã¿                                                           |
| ------------------ | ---------------------------------------------------------------------------- |
| **ã‚»ãƒƒã‚·ãƒ§ãƒ³æ–¹å¼** | ã‚µãƒ¼ãƒå´ã§ `session.invalidate()` ã™ã‚Œã°å³ç„¡åŠ¹åŒ–                             |
| **JWT æ–¹å¼**       | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ãƒˆãƒ¼ã‚¯ãƒ³å‰Šé™¤ã€‚ã‚µãƒ¼ãƒå´ã§ã€Œãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆç®¡ç†ã€ã™ã‚‹å ´åˆã‚‚ã‚ã‚‹ |

---

# âš–ï¸ 5. ä¸¡è€…ã®ã¾ã¨ã‚ï¼ˆã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ™ãƒ«è¦–ç‚¹ï¼‰

| æ¯”è¼ƒé …ç›®     | Cookie ãƒ™ãƒ¼ã‚¹ï¼ˆSessionï¼‰   | JWT ãƒ™ãƒ¼ã‚¹ï¼ˆTokenï¼‰               |
| ------------ | -------------------------- | --------------------------------- |
| çŠ¶æ…‹         | ã‚µãƒ¼ãƒãŒä¿æŒ               | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒä¿æŒ                |
| é€šä¿¡         | Cookieï¼ˆJSESSIONIDï¼‰       | Authorization ãƒ˜ãƒƒãƒ€              |
| Spring è¨­å®š  | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼ˆStatefulï¼‰     | `SessionCreationPolicy.STATELESS` |
| èªè¨¼å‡¦ç†     | HttpSession ã§ç®¡ç†         | Filter ã§ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼             |
| ç„¡åŠ¹åŒ–       | session.invalidate()       | ãƒˆãƒ¼ã‚¯ãƒ³å‰Šé™¤ or ãƒ–ãƒ©ãƒƒã‚¯ãƒªã‚¹ãƒˆ    |
| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ | ã‚µãƒ¼ãƒåˆ¶å¾¡ã§å …ç‰¢           | ãƒˆãƒ¼ã‚¯ãƒ³æµå‡ºãƒªã‚¹ã‚¯ã‚ã‚Š            |
| ã‚¹ã‚±ãƒ¼ãƒ«     | å¼±ã„ï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³å…±æœ‰å¿…è¦ï¼‰ | å¼·ã„ï¼ˆStatelessï¼‰                 |
| é–‹ç™ºç”¨é€”     | Web ã‚¢ãƒ—ãƒªãƒ»ã‚¤ãƒ³ãƒˆãƒ©       | SPA / API / ãƒ¢ãƒã‚¤ãƒ«              |

---

# ğŸ’¡ 6. é¸æŠæŒ‡é‡ï¼ˆSpring Ã— JS ã®å ´åˆï¼‰

| é–‹ç™ºæ§‹æˆ                             | ãŠã™ã™ã‚                      |
| ------------------------------------ | ----------------------------- |
| ã‚µãƒ¼ãƒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ï¼ˆThymeleaf, JSPï¼‰ | ğŸª Cookieï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³èªè¨¼ï¼‰   |
| Vue / React / Angular SPA æ§‹æˆ       | ğŸ”‘ JWTï¼ˆãƒˆãƒ¼ã‚¯ãƒ³èªè¨¼ï¼‰        |
| REST API é€£æºï¼ˆãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ï¼‰    | ğŸ”‘ JWT                        |
| å†…éƒ¨æ¥­å‹™ã‚·ã‚¹ãƒ†ãƒ ï¼ˆç¤¾å†…ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼‰ | ğŸª Cookie                     |
| å¤–éƒ¨ API ã‚’å‘¼ã¶ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰        | ğŸ”‘ JWTï¼ˆCORS å®‰å…¨è¨­å®šã¨å…±ã«ï¼‰ |

---

# ğŸ§± 7. å›³ã§ã¾ã¨ã‚ã‚‹

```
[ Cookieèªè¨¼æ–¹å¼ ]
JS  â‡„  Cookie(JSESSIONID)
     â‡„  Spring Boot (HttpSessionã§ãƒ¦ãƒ¼ã‚¶ãƒ¼çŠ¶æ…‹ä¿æŒ)

[ JWTèªè¨¼æ–¹å¼ ]
JS  â‡„  Authorization: Bearer <token>
     â‡„  Spring Boot (Tokenç½²åæ¤œè¨¼ã§èªè¨¼)
```

---

# ğŸ“˜ ã¾ã¨ã‚

| è¦³ç‚¹        | Cookie èªè¨¼ï¼ˆSessionï¼‰         | JWT èªè¨¼ï¼ˆTokenï¼‰                                |
| ----------- | ------------------------------ | ------------------------------------------------ |
| æœ¬è³ª        | ã‚µãƒ¼ãƒãŒã€Œèª°ã‹ã€ã‚’è¦šãˆã¦ã„ã‚‹   | ãƒˆãƒ¼ã‚¯ãƒ³ãŒã€Œè‡ªåˆ†ã¯èª°ã‹ã€ã‚’è¨¼æ˜ã™ã‚‹               |
| ä»•çµ„ã¿      | Cookie + HttpSession           | JWT + Authorization Header                       |
| ç‰¹å¾´        | çŠ¶æ…‹ã‚’ã‚µãƒ¼ãƒã«ä¿å­˜ï¼ˆStatefulï¼‰ | ãƒˆãƒ¼ã‚¯ãƒ³å†…ã«åŸ‹ã‚è¾¼ã¿ï¼ˆStatelessï¼‰                |
| é©ç”¨ç¯„å›²    | Web ã‚¢ãƒ—ãƒª / ç¤¾å†…ã‚·ã‚¹ãƒ†ãƒ       | SPA / ãƒ¢ãƒã‚¤ãƒ« / API é€£æº                        |
| å®Ÿè£…ã®éµ    | `credentials: "include"`       | `Authorization: Bearer <token>`                  |
| Spring è¨­å®š | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§åˆ©ç”¨å¯             | `SessionCreationPolicy.STATELESS` + ãƒ•ã‚£ãƒ«ã‚¿è¿½åŠ  |

---

æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¨ã—ã¦ã¯ï¼š

-   ğŸ”¹ **Spring Security + JWT ã®å®Œå…¨å®Ÿè£…ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ï¼ˆRefresh ãƒˆãƒ¼ã‚¯ãƒ³ä»˜ãï¼‰**
-   ğŸ”¹ **Cookie + JWT ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ§‹æˆï¼ˆå®‰å…¨ãªãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†ï¼‰**

ã©ã¡ã‚‰ã‚’æ·±æ˜ã‚Šã—ãŸã„ã§ã™ã‹ï¼Ÿ
ã¨ã¦ã‚‚é‹­ã„è³ªå•ã§ã™ã€‚
çµè«–ã‹ã‚‰è¨€ã†ã¨ â”€â”€

> âœ… **JWTï¼ˆãƒˆãƒ¼ã‚¯ãƒ³èªè¨¼ï¼‰ãŒã€Œãƒ¢ãƒ€ãƒ³ã€ãªæ–¹å¼**
> ãŸã ã—ã€Œå¸¸ã«å„ªã‚Œã¦ã„ã‚‹ã€ã‚ã‘ã§ã¯ãªãã€**ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆã«ã‚ˆã£ã¦é©æé©æ‰€**ã§ã™ã€‚

---

## ğŸ§  èƒŒæ™¯ï¼šWeb ã®é€²åŒ–ã¨èªè¨¼ã®å¤‰åŒ–

| æ™‚ä»£                               | ä¸»ãªæ§‹æˆ                                        | èªè¨¼æ–¹å¼                           |
| ---------------------------------- | ----------------------------------------------- | ---------------------------------- |
| ğŸ§± **2000 å¹´ä»£ï¼ˆWeb1.0ï¼‰**         | ã‚µãƒ¼ãƒå´ã§ HTML ç”Ÿæˆï¼ˆJSP, PHP, ASPï¼‰           | Cookie + Sessionï¼ˆã‚µãƒ¼ãƒçŠ¶æ…‹ä¿æŒï¼‰ |
| âš™ï¸ **2010 å¹´ä»£ï¼ˆWeb2.0ï¼‰**         | Ajax ã«ã‚ˆã‚‹å‹•çš„ãƒšãƒ¼ã‚¸                           | åŒä¸Šï¼ˆSession èªè¨¼ä¸»æµï¼‰           |
| ğŸ’ **2020 å¹´ä»£ï¼ˆSPA / API æ™‚ä»£ï¼‰** | React / Vue / Angular + REST API / ãƒ¢ãƒã‚¤ãƒ«é€£æº | JWTï¼ˆStatelessï¼‰ã«ã‚ˆã‚‹ API èªè¨¼    |

ã¤ã¾ã‚Šã€**ãƒ•ãƒ­ãƒ³ãƒˆã¨ãƒãƒƒã‚¯ãŒåˆ†é›¢ã•ã‚ŒãŸ SPA æ§‹æˆä»¥é™ã«èª•ç”Ÿã—ãŸã®ãŒ JWT**ã€‚
ã‚»ãƒƒã‚·ãƒ§ãƒ³èªè¨¼ã¯ã€Œã‚µãƒ¼ãƒãŒç”»é¢ã‚’è¿”ã™æ™‚ä»£ã€ã«è¨­è¨ˆã•ã‚ŒãŸæ–¹å¼ã§ã™ã€‚

---

## âš¡ JWT ãŒãƒ¢ãƒ€ãƒ³ã¨è¨€ã‚ã‚Œã‚‹ç†ç”±

| ç†ç”±                                             | å†…å®¹                                                            |
| ------------------------------------------------ | --------------------------------------------------------------- |
| ğŸŒ **REST / API æ™‚ä»£ã«æœ€é©åŒ–**                   | çŠ¶æ…‹ã‚’æŒãŸãªã„ï¼ˆStatelessï¼‰ãŸã‚ã‚¹ã‚±ãƒ¼ãƒ«ã—ã‚„ã™ã„                 |
| ğŸ“± **ãƒ¢ãƒã‚¤ãƒ« / SPA å¯¾å¿œ**                       | React / Vue / iOS / Android ãªã©ã€Cookie ä¾å­˜ã—ãªã„èªè¨¼ãŒå¯èƒ½   |
| â˜ï¸ **ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ»ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹å¯¾å¿œ**            | è¤‡æ•°ã‚µãƒ¼ãƒ“ã‚¹é–“ã§å…±é€šèªè¨¼ãŒã§ãã‚‹ï¼ˆOAuth2, OpenID Connect å¯¾å¿œï¼‰ |
| ğŸ§© **è¨€èªéä¾å­˜**                                | JSON å½¢å¼ãªã®ã§ã€Java ã§ã‚‚ Python ã§ã‚‚å…±é€šåˆ©ç”¨ã§ãã‚‹            |
| ğŸ”‘ **å¤–éƒ¨ API èªå¯ã®æ¨™æº–ä»•æ§˜ã«çµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹** | Google, AWS, GitHub ãªã©ã‚‚ JWT ãƒ™ãƒ¼ã‚¹ã® OAuth2 ã‚’æ¡ç”¨           |

---

## ğŸ’¡ ä¾‹ï¼šãƒ¢ãƒ€ãƒ³æ§‹æˆã®å…¸å‹ï¼ˆSpring + Vueï¼‰

```
ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰(Vue/React)
   â†“  Authorization: Bearer <JWT>
ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰(Spring Boot)
   â†“  Tokenæ¤œè¨¼ï¼ˆStatelessï¼‰
DBãƒ»ã‚µãƒ¼ãƒ“ã‚¹ç¾¤
```

-   ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã ã‘ `/auth/login` ã§ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œ
-   ä»¥å¾Œã®é€šä¿¡ã¯ `Authorization` ãƒ˜ãƒƒãƒ€ã§é€ä¿¡
-   ã‚µãƒ¼ãƒã¯ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ä¿æŒã›ãšã€è² è·åˆ†æ•£ã‚‚å®¹æ˜“

â¡ ã“ã‚ŒãŒã€Œãƒ¢ãƒ€ãƒ³ï¼ˆç¾ä»£çš„ï¼‰ã€ã¨å‘¼ã°ã‚Œã‚‹æ§‹æˆã§ã™ã€‚

---

## ğŸ§± ä¸€æ–¹ã§ã‚»ãƒƒã‚·ãƒ§ãƒ³èªè¨¼ãŒã¾ã æœ‰åŠ¹ãªã‚±ãƒ¼ã‚¹

| çŠ¶æ³                                        | ç†ç”±                                           |
| ------------------------------------------- | ---------------------------------------------- |
| ğŸ¢ **ç¤¾å†…æ¥­å‹™ã‚·ã‚¹ãƒ†ãƒ ï¼ˆThymeleaf / JSPï¼‰**  | Cookie åˆ¶å¾¡ãŒå®¹æ˜“ã§å®‰å…¨ã€‚å†…éƒ¨ LAN ã§ã‚»ã‚­ãƒ¥ã‚¢ã€‚ |
| ğŸ–¥ **Spring Security ã®ãƒ•ã‚©ãƒ¼ãƒ ãƒ­ã‚°ã‚¤ãƒ³**    | å®Ÿè£…ãŒç°¡å˜ã§ãƒ¡ãƒ³ãƒ†ã‚‚å°‘ãªã„ã€‚                   |
| ğŸ”’ **é«˜ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶ï¼ˆçŸ­å‘½ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰** | ãƒˆãƒ¼ã‚¯ãƒ³æµå‡ºãƒªã‚¹ã‚¯ã‚’é¿ã‘ã‚‰ã‚Œã‚‹ã€‚               |

â¡ ç¤¾å†…ã‚·ã‚¹ãƒ†ãƒ ãƒ»ã‚¤ãƒ³ãƒˆãƒ©ç’°å¢ƒã§ã¯ä»Šã§ã‚‚**ã‚»ãƒƒã‚·ãƒ§ãƒ³èªè¨¼ãŒæœ€é©è§£**ãªã“ã¨ã‚‚å¤šã„ã§ã™ã€‚

---

## âš–ï¸ ãƒ¢ãƒ€ãƒ³åº¦ã‚’æ¯”è¼ƒï¼ˆæ„Ÿè¦šçš„ãªã‚¹ã‚³ã‚¢ï¼‰

| é …ç›®                       | ã‚»ãƒƒã‚·ãƒ§ãƒ³èªè¨¼      | JWT èªè¨¼                       |
| -------------------------- | ------------------- | ------------------------------ |
| ãƒ¢ãƒ€ãƒ³åº¦                   | â˜…â˜…â˜†â˜†â˜†ï¼ˆã‚¯ãƒ©ã‚·ãƒƒã‚¯ï¼‰ | â­â­â­â­â­ï¼ˆSPA/API æ™‚ä»£æ¨™æº–ï¼‰ |
| ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£           | ä¸­                  | é«˜                             |
| ãƒ¢ãƒã‚¤ãƒ«é€£æº               | å¼±ã„                | å¼·ã„                           |
| ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹å¯¾å¿œ       | é›£                  | å®¹æ˜“                           |
| å®Ÿè£…ã®ã‚·ãƒ³ãƒ—ãƒ«ã•           | â—                   | â–³ï¼ˆç½²åãƒ»æ¤œè¨¼ãŒå¿…è¦ï¼‰          |
| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ | å¼·ã„                | æ³¨æ„ç‚¹ã‚ã‚Šï¼ˆæœ‰åŠ¹æœŸé™ç®¡ç†ï¼‰     |

---

## ğŸ§­ çµè«–ï¼šã©ã¡ã‚‰ã‚’æ¡ç”¨ã™ã¹ãã‹

| é–‹ç™ºæ§‹æˆ                                        | æ¨å¥¨æ–¹å¼   | ç†ç”±                              |
| ----------------------------------------------- | ---------- | --------------------------------- |
| âœ… **SPA æ§‹æˆ (Vue / React + Spring Boot API)** | JWT        | Cookie ä¸è¦ã€CORS å¯¾å¿œã—ã‚„ã™ã„    |
| âœ… **ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒª (iOS / Android + API)**     | JWT        | ãƒã‚¤ãƒ†ã‚£ãƒ–é€£æºã—ã‚„ã™ã„            |
| âœ… **ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹æ§‹æˆ**                     | JWT        | ã‚µãƒ¼ãƒ“ã‚¹é–“å…±é€šèªè¨¼ãŒå¯èƒ½          |
| âœ… **å¤–éƒ¨ API é€£æº**                            | JWT        | OAuth2, OpenID Connect ã¨ã®äº’æ›æ€§ |
| âš™ï¸ **ç¤¾å†… Web ã‚¢ãƒ—ãƒªï¼ˆã‚µãƒ¼ãƒãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ï¼‰**    | ã‚»ãƒƒã‚·ãƒ§ãƒ³ | å®‰å®šãƒ»å˜ç´”ã§å®‰å…¨                  |
| âš™ï¸ **èªè¨¼å¾Œã«ç”»é¢ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ä¸­å¿ƒ**             | ã‚»ãƒƒã‚·ãƒ§ãƒ³ | Spring æ¨™æº–æ§‹æˆã§å®Ÿç¾å¯èƒ½         |

---

## ğŸ’¬ ã¾ã¨ã‚

| è¦³ç‚¹        | ã‚»ãƒƒã‚·ãƒ§ãƒ³èªè¨¼           | JWT èªè¨¼                      |
| ----------- | ------------------------ | ----------------------------- |
| ä¸–ä»£æ„Ÿ      | å¾“æ¥å‹ï¼ˆ2000 å¹´ä»£ï½ï¼‰    | ãƒ¢ãƒ€ãƒ³ï¼ˆSPA/API æ™‚ä»£ï¼‰        |
| çŠ¶æ…‹ç®¡ç†    | Statefulï¼ˆã‚µãƒ¼ãƒã«ä¿å­˜ï¼‰ | Statelessï¼ˆãƒˆãƒ¼ã‚¯ãƒ³å†…ã«æƒ…å ±ï¼‰ |
| é©ç”¨ç¯„å›²    | Web ã‚¢ãƒ—ãƒª               | API / SPA / ãƒ¢ãƒã‚¤ãƒ«          |
| Spring æ¨™æº– | å¯¾å¿œæ¸ˆã¿                 | è¦ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºï¼ˆFilter è¿½åŠ ï¼‰ |
| ãƒ¢ãƒ€ãƒ³åº¦    | ä¸­                       | é«˜ï¼ˆOAuth2 æ™‚ä»£ã®æ¨™æº–ï¼‰       |

> ğŸ”¹ ã¤ã¾ã‚Šã€
>
> -   ã€ŒWeb ã‚¢ãƒ—ãƒªã€ãªã‚‰ã‚»ãƒƒã‚·ãƒ§ãƒ³
> -   ã€ŒAPI é€£æº or SPAã€ãªã‚‰ JWT
>
> ãã—ã¦ã€Œãƒ¢ãƒ€ãƒ³ã€ã¨å‘¼ã°ã‚Œã‚‹ã®ã¯å¾Œè€…ï¼ˆJWT èªè¨¼ï¼‰ã§ã™ã€‚

---

ã‚‚ã—æ¬¡ã«é€²ã‚ã‚‹ãªã‚‰ã€
ğŸ”¸ **Spring Security ã§ JWT ã‚’å®Ÿè£…ã™ã‚‹å®Œå…¨ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ï¼ˆToken ç™ºè¡Œã€œæ¤œè¨¼ã¾ã§ï¼‰**
ã‚’ã‚³ãƒ¼ãƒ‰ä»˜ãã§èª¬æ˜ã§ãã¾ã™ã€‚
ã‚„ã‚Šã¾ã™ã‹ï¼Ÿ
